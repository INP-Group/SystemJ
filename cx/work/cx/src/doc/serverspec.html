<HTML>
<HEAD>
<TITLE>Указание имени сервера в CX-протоколе</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="style.css">
</HEAD>
<BODY>

<H1>Указание имени сервера в CX-протоколе</H1>

<H2>Общий формат</H2>

<P>Полное имя (спецификация) сервера в CX, по аналогии с X11,
состоит из двух частей: имени хоста и отделенного двоеточием номера
сервера.  Пример полной спецификации:

<BLOCKQUOTE><PRE>
linac1:5
</PRE></BLOCKQUOTE>

<P>Имя хоста может быть коротким (<TT>linac1</TT>), полным -- с доменом
(<TT>linac1.inp.nsk.su</TT>) и в виде IP-адреса.  Следующие три
спецификации эквивалентны:

<BLOCKQUOTE><PRE>
linac1:5
linac1.inp.nsk.su:5
193.124.164.125:5
</PRE></BLOCKQUOTE>

<P>Как имя хоста, так и номер сервера могут опускаться, при этом
именем хоста по умолчанию является "<TT>localhost</TT>", а номером сервера по
умолчанию -- <TT>0</TT>.  Примеры неполных спецификаций:

<BLOCKQUOTE><PRE>
linac1		// linac1:0
:5		// localhost:5
</PRE></BLOCKQUOTE>

<P>Пустая строка ("") или отсутствующая (NULL) спецификация сервера
рассматривается как "<TT>localhost:0</TT>", но если определена
переменная окружения <CODE>CX_SERVER</CODE>, то берется ее значение
(которое также может быть частичной спецификацией, и дополняется до
полной обычным образом -- хост по умолчанию -- "<TT>localhost</TT>",
сервер по умолчанию -- <TT>0</TT>). В этом смысле переменная окружения
<CODE>CX_SERVER</CODE> эквивалентна переменной
<CODE>DISPLAY</CODE> для X11.


<H2>Выбор протокола соединения</H2>

<P>Обычно связь CX-клиента с CX-сервером осуществляется по TCP/IP.
Однако, если клиент и сервер запускаются на одной и той же машине, то
связь осуществляется по более быстрому протоколу unix sockets. 

<P>Машины клиента и сервера считаются одной и той же, если или адрес
сервера -- 127.0.0.1, или адрес сервера совпадает с адресом машины, на
которой запущен клиент (точнее -- с адресом, связанным с ее основным
именем, поскольку "адрес машины клиента" определяется при помощи
<CODE>gethostbyname(uname().nodename)</CODE>; в большинстве случаев у
машины просто одно имя и один адрес).

<P>Данный способ "ускорения связи" также аналогичен используемому в
X11.


<H2>Точное указание порта</H2>

<P>Номер сервера связан с номером IP-порта --
<CODE>порт=номер+8012</CODE>.  Однако в некоторых случаях необходимо
точное указание порта -- например, если требуется организовать
туннелирование CX-траффика, и прокси расположена на некоем конкретном
порту.

<P>Такая возможность предусмотрена: при указании "отрицательного"
номера сервера этот номер (после отбрасывания минуса) рассматривается
как точный номер порта.  Например,

<BLOCKQUOTE><PRE>
proxy.inp.nsk.su:-8888
</PRE></BLOCKQUOTE>

означает, что соединение должно производиться с портом 8888.

<P>При этом логика проверки "клиент и сервер работают на одной
машине" отключается и соединение всегда производится по TCP/IP.  Это
позволяет корректно работать со спецификациями наподобие

<BLOCKQUOTE><PRE>
localhost:-4007
</PRE></BLOCKQUOTE>


<H2>Замечания о будущем развитии</H2>

	В будущем предусматривается, "по образу и подобию" X11,
поддерживать протокол IPv6.  При этом будут использоваться все те же
основные правила (с поправкой на то, что спецификация адреса в IPv6
сама содержит двоеточия).

	Кроме того, в будущем планируется поддержка транспорта через
MIT SHM для максимально быстрой передачи больших объемов данных
(например, видеопотока).


</BODY>
</HTML>

