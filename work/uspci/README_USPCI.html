<HTML>
<HEAD>
<TITLE>README_USPCI - USPCI installation &amp; programming manual</TITLE>

<STYLE TYPE="text/css">
<!--
CODE,PRE     {color:      #1818b2}
TT           {color:      #18b218}
-->
</STYLE>

</HEAD>
<BODY>

<H1>USPCI installation &amp; programming manual</H1>

<H2>Contents</H2>

<OL TYPE=I>

<LI><A HREF="#introduction">Introduction</A>

<LI><A HREF="#installation">Installation</A>

  <OL>

  <LI><A HREF="#installation.building">Building</A>

  <LI><A HREF="#installation.bringing_up">Bringing up</A>

  </OL>

<LI><A HREF="#programming">Programming</A>

  <OL>

  <LI><A HREF="#programming.basic">Basic concepts</A>

  <LI><A HREF="#programming.opening">Opening a PCI device</A>

  <LI><A HREF="#programming.io">Performing I/O</A>

  <LI><A HREF="#programming.irq">IRQ handling</A>

  </OL>

<LI><A HREF="#uspci_test"><TT>uspci_test</TT> utility</A>

</OL>


<H2><A NAME="#introduction"></A>Introduction</H2>


<H2><A NAME="#installation"></A>Installation</H2>


  <H3><A NAME="#installation.building"></A>Building</H3>

<P>To build and install USPCI suite:

  <OL>

  <LI>Unpack the distribution.

  <LI>Cd into its directory.

  <LI>Type "<TT>make</TT>".  This builds both the kernel module
<TT>uspci.ko</TT> (in <TT>kernel_module/</TT>) and <TT>uspci_test</TT>
utility (in <TT>utils/</TT>).

  <LI>Place the <TT>uspci.ko</TT> to an appropriate location where it
can be found by depmod and insmod/modprobe, usually

<PRE>/lib/modules/$(shell uname -r)/extra/</PRE>

  <LI>Place the <TT>uspci_test</TT> utility to whichever location is
convenient, e.g. <TT>/usr/local/bin/</TT>.

  </OL>

  <H3><A NAME="#installation.bringing_up"></A>Bringing up</H3>

To bring the USPCI kernel module up at boot, place the following
commands, e.g. into <TT>/etc/rc.d/rc.local</TT>:

<PRE>
# Load UserSpace-PCI module
rm -f /dev/uspci
if modprobe -v uspci
then
        major=$(awk '$2=="uspci" {print $1}' /proc/devices)
        mknod /dev/uspci c $major 0
fi
</PRE>

<H2><A NAME="#programming"></A>Programming</H2>


  <H3><A NAME="#programming.basic"></A>Basic concepts</H3>


  <H3><A NAME="#programming.opening"></A>Opening a PCI device</H3>


  <H3><A NAME="#programming.io"></A>Performing I/O</H3>


  <H3><A NAME="#programming.irq"></A>IRQ handling</H3>


<H2><A NAME="#uspci_test"></A><TT>uspci_test</TT> utility</H2>

<P>The <TT>uspci_test</TT> utility allows to interact with PCI devices
from command line.  Its features include performing I/O, IRQ handling
and waiting.  The <TT>uspci_test</TT> is located in the <TT>utils/</TT>
subdir.


</BODY>
</HTML>
